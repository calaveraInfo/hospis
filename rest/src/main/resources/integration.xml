<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:int="http://www.springframework.org/schema/integration" xmlns:int-jms="http://www.springframework.org/schema/integration/jms"
	xmlns:amq="http://activemq.apache.org/schema/core"
	xsi:schemaLocation="
       http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core-5.10.1.xsd
       http://www.springframework.org/schema/integration/jms http://www.springframework.org/schema/integration/jms/spring-integration-jms-4.1.xsd
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd
       http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration-4.1.xsd">

	<int:gateway service-interface="cz.cestadomu.hospis.rest.gateway.TestGateway"
		default-request-channel="jmsOutboundChannel" />

	<int:channel id="jmsOutboundChannel" />

	<int-jms:outbound-gateway request-destination-name="outQueue"
		request-channel="jmsOutboundChannel" connection-factory="jmsFactory" />

	<int-jms:inbound-gateway connection-factory="jmsFactory"
		request-destination-name="testQueue" request-channel="jmsInboundChannel" />

	<int:channel id="jmsInboundChannel" />

	<int:transformer expression="payload.toUpperCase()" input-channel="jmsInboundChannel" />

	<amq:broker useJmx="true" persistent="false">
		<amq:transportConnectors>
			<amq:transportConnector uri="tcp://localhost:0" />
		</amq:transportConnectors>
	</amq:broker>

	<amq:queue id="testQueue" physicalName="org.apache.activemq.spring.Test.spring.embedded" />

	<amq:connectionFactory id="jmsFactory" brokerURL="vm://localhost" />

	<!-- <reply-listener/> -->

</beans>